# Типы карточек

| Поле | Значение |
| --- | --- |
| Цель | Зафиксировать требования к учебным карточкам и их типам |
| Аудитория | Разработчики, AI агент |
| Ответственный | Команда разработки |
| Последнее обновление | 2025-12-23 |
| Связанные документы | [Прогресс карточек](./card_progress.md), [ER-диаграмма](../data/er_diagram.mermaid) |
| Ключевые классы | `LessonCardTypeService`, `TranslateLessonCardTypeService` |

## Описание

Для изучения слов используются различные типы изучаемых карточек. Например, для изучения в виде: слово и его перевод, обратный перевод, ввод перевода с клавиатуры и др.
Карточка не обязательно должна быть связанна с одним словом, карточка может объединять несколько слов. Например, при выборе перевода из нескольких вариантов.
Карточки могут иметь различные варианты оформления вопроса для пользователя, способы получения ответов, а также подходы к их проверке.
Для большей вариабельности реализации каждый тип карточки представлен отдельным фрагментом с суффиксом `card_type`, а также реализует интерфейс `LessonCardTypeService`.
Доступные типы карточек перечислены в перечислении `CardTypeEnum`.
Интерфейс объединяющий все карточки `LessonCardDto`

## Список типов карточек

### Прямой перевод

Тип карты - `CardTypeEnum.TRANSLATE`  
DTO - `TranslateLessonCardDto`  
Сервис - `TranslateLessonCardTypeService`  
Фрагмент - `TranslateCardTypeFragment`

Это базовый тип карточки, при котором пользователь видит слово на изучаемом языке и ему необходимо вспомнить его перевод.
Оформление этого типа карточки походит на реальную карточку у которой с одной стороны вопрос, а с другой ответ.
Правильность ответа пользователь проверяет самостоятельно, сам оценивая свои знания.
На стороне карточки с вопросом пользователь должен видеть, сверху вниз: 
- изображение-подсказку, изображение должно быть размытым
- слово на английском и кнопка озвучки слова
- подсказка, если есть
- кнопка "Показать перевод" (внизу экрана)

После нажатия на кнопку "Показать перевод" отображается обратная сторона карточки с ответом, которая в большей степени повторяет сторону с вопросом. На ней пользователь видит следующие элементы, сверху вниз:
- изображение-подсказка, не размытое
- слово на английском и кнопка озвучки слова
- подсказка, если есть
- слово на русском
- три кнопки: сложно (качество ответа - 0), средне (качество ответа - 3), легко (качество ответа - 5)

После нажатия на кнопки с оценкой знания карточка либо возвращается на повторное изучение, если нажата кнопка "сложно", либо будет показана на следующем занятии, если нажаты другие кнопки. Изменение статуса и расчет следующей даты повторения описан в документе [Прогресс карточек](./card_progress.md).
Также для данного типа карточек при открытии должна проигрываться озвучка английского слова.

Визуальное отображение карточки и ее двух сторон условное. Ее фрагмент не должен содержать какой-либо анимации или переходов. Должен быть выполнен в минималистичном дизайне и включать только функциональные элементы. 

### Обратный перевод

Тип карты - `CardTypeEnum.REVERSE_TRANSLATE`  
DTO - `ReverseTranslateLessonCardDto`  
Сервис - `ReverseTranslateLessonCardTypeService`  
Фрагмент - `ReverseTranslateCardTypeFragment`

Это базовый тип карточки, при котором пользователь видит перевод слова на его родном языке и ему необходимо вспомнить это слово на изучаемом языке.
Оформление этого типа карточки походит на реальную карточку у которой с одной стороны вопрос, а с другой ответ.
Правильность ответа пользователь проверяет самостоятельно, сам оценивая свои знания.
На стороне карточки с вопросом пользователь должен видеть, сверху вниз:
- изображение-подсказка
- слово на русском
- подсказка, если есть
- кнопка "Показать перевод" (внизу экрана)

После нажатия на кнопку "Показать перевод" отображается обратная сторона карточки с ответом, которая в большей степени повторяет сторону с вопросом. На ней пользователь видит следующие элементы, сверху вниз:
- изображение-подсказка
- слово на русском
- подсказка, если есть
- слово на английском и кнопка озвучки слова
- три кнопки: сложно (качество ответа - 0), средне (качество ответа - 3), легко (качество ответа - 5)

После нажатия на кнопки с оценкой знания карточка либо возвращается на повторное изучение, если нажата кнопка "сложно", либо будет показана на следующем занятии, если нажаты другие кнопки. Изменение статуса и расчет следующей даты повторения описан в документе [Прогресс карточек](./card_progress.md).
Также, после нажатия на кнопку "Показать перевод" должна проигрываться озвучка английского слова.

Визуальное отображение карточки и ее двух сторон условное. Ее фрагмент не должен содержать какой-либо анимации или переходов. Должен быть выполнен в минималистичном дизайне и включать только функциональные элементы.

### Ввод слова

Тип карты - `CardTypeEnum.ENTER_WORD`  
DTO - `EnterWordLessonCardDto`  
Сервис - `EnterWordLessonCardTypeService`  
Фрагмент - `EnterWordCardTypeFragment`

Это тип карточки, при котором пользователь видит перевод слова на его родном языке.
Правильность ответа пользователь проверяет самостоятельно, сам оценивая свои знания. Но при этом, после нажатия на кнопку "Показать перевод" пользователь должен видеть где он ошибся.
На карточке пользователь видит следующие элементы, сверху вниз:
- изображение-подсказка
- слово на русском
- подсказка, если есть
- поле ввода для ответа пользователя. При включении карточки фокус ввода должен быть на этом поле. При вводе не должны работать помощники ввода, автокоррекция и другие подсказки. Кнопка "галочка" га клавиатуре соответствует кнопке "Показать перевод"
- кнопка "Показать перевод" (внизу экрана)

После нажатия на кнопку "Показать перевод" отображается обратная сторона карточки с ответом, которая в большей степени повторяет сторону с вопросом. На ней пользователь видит следующие элементы, сверху вниз:
- изображение-подсказка
- слово на русском
- подсказка, если есть
- слово на английском и кнопка озвучки слова
- ответ пользователя с подсветкой правильно введенных символов и ошибок. Правильно введенные символы на зеленом фоне, пропущенные символы на желтом фоне, неверные буквы на красном фоне. Для этого необходимо использовать метод ```TextDiffHighlighter.buildColoredAnswer()``` 
- три кнопки: сложно (качество ответа - 0), средне (качество ответа - 3), легко (качество ответа - 5)

После нажатия на кнопки с оценкой знания карточка либо возвращается на повторное изучение, если нажата кнопка "сложно", либо будет показана на следующем занятии, если нажаты другие кнопки. Изменение статуса и расчет следующей даты повторения описан в документе [Прогресс карточек](./card_progress.md).

### Сопоставление перевода

Тип карты - `CardTypeEnum.TRANSLATION_COMPARISON`
DTO - `TranslationComparisonLessonCardDto`
Сервис - `TranslationComparisonLessonCardTypeService`
Фрагмент - `TranslationComparisonCardTypeFragment`

Карточка показывает сразу несколько слов (от 2 до 5) и их переводы. Пользователь должен выстроить пары «слово → перевод», переставляя элементы в левой и правой колонке. 
Правильность ответа пользователя оценивается по правильности сопоставления.

На карточке пользователь видит следующие элементы, сверху вниз:
- текст описание задания на карточке;
- два списка слов: слева слова на английском, справа их перевод. Порядок в списках слов можно менять через drag&drop;
- кнопка "Показать перевод".

После нажатия на кнопку «Показать перевод» кнопка "Показать перевод" карточка фиксируется и отображает правильные сопоставления:

- корректные пары подсвечиваются зеленым цветом;
- ошибочно подобранные переводы подсвечиваются красным;
- порядок слов в левой колонке сохраняется в том виде, в котором пользователь разгруппировал пары.

Также после нажатия на кнопку "Показать перевод", кнопка заменяется на кнопку "Дальше", при нажатии на которую сохраняется прогресс и карточка либо выучена, либо возвращается на повторное изучение.
Если допущена хотя бы одна ошибка, карточка остаётся в текущей сессии: сервис возвращает обновлённую карточку с теми же `progressId`, чтобы пользователь повторил попытку. 
Каждый прогресс в карточке пересчитывается отдельно по SM-2: верно сопоставленные слова переводятся в состояние `IN_PROGRESS` с качеством ответа равным пяти, ошибочные переходят в `PROGRESS_RESET` с качеством ответа равным нолю. При полностью верном ответе карточка больше не показывается в текущем уроке.
После нажатия на кнопку "Дальше" переходим к следующей карточке.

Формирование карточки:
- выбираются случайные прогрессы типа `TRANSLATION_COMPARISON` для урока;
- если сегодня доступно меньше двух слов, карточка не создаётся;
- если слов больше пяти, список разбивается на независимые карточки по пять элементов (последняя карточка может быть меньше).

## Что менять при доработке

- При добавлении нового типа карточки реализуй `LessonCardDto`
- При добавлении нового типа карточки создай отдельный фрагмент с суффиксом `card_type` и реализуй `LessonCardTypeService`.
- Обнови перечисление `CardTypeEnum` и таблицу `lesson_card_types`, чтобы тип был доступен в уроках.
- Расширь документацию раздела «Список типов карточек» описанием UX и требований к проверке ответа.



